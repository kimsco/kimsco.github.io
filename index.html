<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>1RM 계산기 + 3대 기록표</title>
<style>
body {
    background: black;
    color: white;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;
    text-align: center;
    padding: 70px 20px 20px 20px;
}
.container { max-width: 400px; margin: auto; }
.subtitle { font-size:16px;  margin-top: 40px; margin-bottom: 20px; }

select, button {
    width:100%; padding:14px; margin:10px 0; font-size:18px;
    border-radius:10px; border:none; text-align:center;
}
button { font-size:20px; background:white; color:black; font-weight:bold; cursor:pointer; }
#result { margin-top:20px; font-size:22px; }
table { width:100%; margin-top:15px; border-collapse: collapse; }
table, td { border:1px solid white; }
td { padding:8px; text-align:center; }

#loginArea {
    position: absolute;
    top: 10px;
    left: 10px;
    display: flex;
    flex-direction: column;
    gap: 6px;
    padding: 8px;
    background: rgba(0,0,0,0.5);
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.3);
}
#loginArea button { padding: 8px 12px; font-size: 13px; border-radius:6px; }
#userInfo { font-size:12px; color:#fff; text-align:center; }

/* 탭 스타일 */
.tab { display:flex; justify-content:center; gap:10px; margin-bottom:20px; }
.tab button { padding:10px 20px; border:none; border-radius:8px; cursor:pointer; background:#333; color:white; font-weight:bold; }
.tab button.active { background:#FFD700; color:black; }

/* 탭 컨텐츠 숨기기 */
.tabContent { display:none; }
.tabContent.active { display:block; }

/* 3대 총합 강조 */
#total3 { font-size:28px; font-weight:bold; margin-bottom:15px; color:#FFD700; }

/* 3대 기록표 개선 */
table.ThreeRM { margin:auto; width:100%; max-width:380px; }
table.ThreeRM td { padding:10px; width:33%; }
input.rmInput { width:100%; height:40px; font-size:18px; text-align:center; background:transparent; color:#fff; border-radius:6px; }

/* 3대 기록 저장 버튼 */
#save3Btn { 
    width:100%; 
    padding:14px; 
    font-size:18px; 
    margin-top:10px; 
    border-radius:10px; 
    border:none; 
    background:white; 
    color:black; 
    font-weight:bold; 
    cursor:pointer;
}

/* 폴더 버튼 (가로 정렬) */
.recordFolders {
    display:flex;
    justify-content:center;
    gap:10px;
    margin-top:20px;
}
.folderBtn {
    padding:10px 12px;
    border:none;
    border-radius:8px;
    background:#333;
    color:white;
    font-weight:bold;
    cursor:pointer;
    min-width:100px;
}
.folderBtn.active {
    background:#FFD700;
    color:black;
}

/* 하나의 박스(탭처럼 교체) */
.folderContent {
    display:none;
    margin-top:15px;
    width:100%;
    height:150px;
    background:#555;
    border-radius:8px;
    padding:10px;
    box-sizing:border-box;
    text-align:left;
    overflow:auto;
}
.folderContent.active {
    display:block;
}

/* 입력폼 한줄 가로배치 (부모) */
.recordFormRow {
    display: flex;                 /* 가로 정렬 */
    gap: 8px;                      /* 요소 사이 간격 */
    margin-top: 12px;
    width: 100%;
    max-width: 380px;              /* 전체 줄 최대 폭 */
    margin-left: auto;
    margin-right: auto;
    align-items: center;           /* 세로 높이 중앙정렬 */
}

/* 숫자 입력 (무게, 횟수) */
.recordFormRow input[type="number"] {
    width: 90px;                   /* 전부 같은 폭 */
    height: 40px;                  /* 전부 같은 높이 */
    padding: 0 6px;
    border-radius: 6px;
    border: none;
    font-size: 14px;
    box-sizing: border-box;
}

/* 저장 버튼 */
.recordFormRow button {
    height: 40px;                  /* 입력칸과 동일 높이 */
    padding: 0 12px;               /* 가로 여백만 */
    border-radius: 6px;
    border: none;
    background: #fff;
    color: #000;
    font-weight: 700;
    cursor: pointer;
}

/* 날짜 컨트롤 영역 */
.recordDateWrap {
    margin-top: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
}
#dateToggleBtn {
    width: auto;
    padding: 6px 12px;
    font-size: 13px;
    border-radius: 6px;
    background: #333;
    color: #fff;
    cursor: pointer;
}
#recordDatePicker {
    margin-top: 6px;
    height: 34px;
    border-radius: 6px;
    border: none;
    padding: 0 6px;
}

/* 페이드 메시지 */
.fade {
    transition: opacity 0.8s ease;
}
#save3Result { margin-top:10px; font-size:16px; opacity:1; }
#recordMessage { margin-top:8px; font-size:14px; opacity:1; color:#fff; }

/* 숫자 입력창의 + - 버튼 제거 (크롬, 엣지) */
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

/* 파이어폭스 */
input[type="number"] {
    -moz-appearance: textfield;
}

/* 로그인 area hide on scroll */
</style>
</head>
<body>

<div class="container">
    <div class="subtitle">"대부분의 문제는 돈이 없어서, 그 외의 문제는 근육이 없어서 생긴다"</div>
    <h2>1RM 계산기</h2>

    <!-- 탭 -->
    <div class="tab">
        <button class="tabBtn active" data-target="tab1">1RM 계산기</button>
        <button class="tabBtn" data-target="tab2">3대 기록표</button>
    </div>

    <!-- 1RM 계산기 -->
    <div id="tab1" class="tabContent active">
        <select id="weight"><option value="">무게 선택</option></select>
        <select id="reps"><option value="">반복수 선택</option></select>
        <button id="goBtn">GO</button>
        <div id="result"></div>
        <div id="tableArea"></div>
        <div id="saveResult" style="margin-top:20px; font-size:18px;"></div>
    </div>

    <!-- 3대 기록표 -->
    <div id="tab2" class="tabContent">
        <div id="total3">3대: 0 kg</div>
        <table class="ThreeRM">
            <tr>
                <td>벤치</td>
                <td>스쿼트</td>
                <td>데드</td>
            </tr>
            <tr>
                <td><input type="number" id="benchRM" class="rmInput" placeholder="kg" min="0"></td>
                <td><input type="number" id="squatRM" class="rmInput" placeholder="kg" min="0"></td>
                <td><input type="number" id="deadRM" class="rmInput" placeholder="kg" min="0"></td>
            </tr>
        </table>

        <!-- 기존 3대 저장 버튼 (항상 보임) -->
        <button id="save3Btn">3대 기록 저장</button>
        <div id="save3Result" class="fade" style="margin-top:8px;font-size:15px;"></div>

        <!-- 폴더 버튼 (가로) -->
        <div class="recordFolders" role="tablist" aria-label="기록 탭">
            <button class="folderBtn active" data-target="benchBox">벤치 기록</button>
            <button class="folderBtn" data-target="squatBox">스쿼트 기록</button>
            <button class="folderBtn" data-target="deadBox">데드 기록</button>
        </div>

        <!-- 하나의 박스 영역 (버튼 누르면 내용 교체) -->
        <div id="benchBox" class="folderContent active"></div>
        <div id="squatBox" class="folderContent"></div>
        <div id="deadBox" class="folderContent"></div>

        <!-- 날짜 토글 영역 -->
        <div class="recordDateWrap">
            <button type="button" id="dateToggleBtn">날짜 변경</button>
            <input type="date" id="recordDatePicker" style="display:none;">
        </div>

        <!-- 입력폼 (가로 한줄) -->
        <div class="recordFormRow">
            <input type="number" id="recordWeight" placeholder="무게(kg)" />
            <input type="number" id="recordReps" placeholder="횟수" />
            <button id="recordAdd">저장</button>
        </div>
        <div id="recordMessage" class="fade"></div>
    </div>
</div>

<!-- 로그인 영역 -->
<div id="loginArea">
    <button id="googleLoginBtn">Google 로그인</button>
    <button id="logoutBtn" style="display:none;">로그아웃</button>
    <div id="userInfo"></div>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

<script>
// ==================== 요소 참조 ====================
const tabBtns = document.querySelectorAll('.tabBtn');
const tabContents = document.querySelectorAll('.tabContent');

const weightSelect = document.getElementById('weight');
const repsSelect = document.getElementById('reps');
const goBtn = document.getElementById('goBtn');
const resultDiv = document.getElementById('result');
const tableArea = document.getElementById('tableArea');

const benchRM = document.getElementById('benchRM');
const squatRM = document.getElementById('squatRM');
const deadRM = document.getElementById('deadRM');
const total3 = document.getElementById('total3');

const save3Btn = document.getElementById('save3Btn');
const save3Result = document.getElementById('save3Result');

const folderBtns = document.querySelectorAll('.folderBtn');
const folderContents = document.querySelectorAll('.folderContent');

const benchBox = document.getElementById('benchBox');
const squatBox = document.getElementById('squatBox');
const deadBox = document.getElementById('deadBox');

const recordWeight = document.getElementById('recordWeight');
const recordReps = document.getElementById('recordReps');
const recordAdd = document.getElementById('recordAdd');
const recordMessage = document.getElementById('recordMessage');

const dateToggleBtn = document.getElementById('dateToggleBtn');
const recordDatePicker = document.getElementById('recordDatePicker');

// ==================== 날짜 초기값 ====================
function formatTodayYYMMDD(d = new Date()){
    const yy = String(d.getFullYear()).slice(2);
    const mm = String(d.getMonth()+1).padStart(2,'0');
    const dd = String(d.getDate()).padStart(2,'0');
    return `${yy}.${mm}.${dd}`;
}

// ==================== 날짜 토글 ====================
dateToggleBtn.addEventListener('click', () => {
    recordDatePicker.style.display =
        recordDatePicker.style.display === 'none' ? 'block' : 'none';
});

// ==================== 나머지 기존 JS (1RM 계산, 기록 추가 등) ====================
// 기존 로직 그대로 유지하되, 기록 저장시 날짜는 아래처럼 처리:
recordAdd.addEventListener('click', async ()=>{
    const weight = parseInt(recordWeight.value);
    const reps = parseInt(recordReps.value);
    if(!weight || !reps){
        recordMessage.textContent = '무게와 횟수를 입력하세요';
        return;
    }
    const date = recordDatePicker.value
        ? recordDatePicker.value.slice(2).replace(/-/g, '.')
        : formatTodayYYMMDD();

    // active folder 결정
    const activeBtn = document.querySelector('.folderBtn.active');
    const target = activeBtn ? activeBtn.dataset.target : 'benchBox';

    // records에 추가
    const item = { date, weight, reps };
    if(target === 'benchBox') records.bench.unshift(item);
    else if(target === 'squatBox') records.squat.unshift(item);
    else if(target === 'deadBox') records.dead.unshift(item);

    // 입력 초기화
    recordWeight.value = '';
    recordReps.value = '';
    recordDatePicker.value = '';

    // 렌더링
    renderActiveBox();
});
</script>
</body>
</html>
