<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>1RM ê³„ì‚°ê¸° + 3ëŒ€ ê¸°ë¡í‘œ</title>

<style>
/* ===============================
   ğŸ”¥ ì „ì²´ ë ˆì´ì•„ì›ƒ (í° ë¹„ìœ¨ ê³ ì •)
================================ */
html, body {
    margin: 0;
    padding: 0;
    width: 100%;

   
    height: 100%;
    overflow: hidden;
}

body { 
    background: #111; 
   
    color: white;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;
}

.app {
    width: 390px;
    height: 100vh;          /* ğŸ”¥ min-height âŒ */
    margin: 0 auto;

    background: black;
    padding: 0 20px 20px;
    box-sizing: border-box;

    overflow-y: auto;       /* âœ… ì–˜ë§Œ ìŠ¤í¬ë¡¤ */
    overflow-x: hidden;
-ms-overflow-style: none;  /* IE, Edge */
    scrollbar-width: none;     /* Firefox */
   
    -webkit-overflow-scrolling: touch;

}

.app::-webkit-scrollbar {
    display: none;             /* Chrome, Safari */
}

/* ===============================
   ê³µí†µ
================================ */
.container { max-width: 100%; margin: auto; }
.subtitle { font-size:16px; margin-bottom:20px; }
 
select, button, input {
    width:100%;
    padding:14px;
    margin:10px 0;
    font-size:18px;
    border-radius:10px;
    border:none;
    box-sizing: border-box;
}

button {
    background:white;
    color:black;
    font-weight:bold;
    cursor:pointer;
}

#result { margin-top:20px; font-size:22px; }
table input {
    width: 100%;
    box-sizing: border-box;
      padding: 8px;
}
table {
    width:100%;
    margin-top:15px;
    border-collapse: collapse;
    table-layout: fixed; /* ğŸ”¥ ì´ê±° ì¤‘ìš” */
}
table, td, th {
    border:1px solid white;
}
td, th {
    padding:8px;
    text-align:center;
}

/* ===============================
   ë¡œê·¸ì¸ ì˜ì—­
================================ */
  
.topBar {
  display: flex;
  justify-content: space-between;
  align-items: center;

  padding: 12px 14px;
}

   .topText {
  color: white;
  font-size: 0.66em; /* ê¸°ì¡´ subtitle ëŒ€ë¹„ 2/3 */
  line-height: 1.4;
  opacity: 0.85;
}

#loginArea {
    display: flex;
    align-items: center;
    gap: 6px;
}

#loginArea button {
    padding: 6px 10px;
    font-size: 12px;
    border-radius: 6px;
    white-space: nowrap;
}

#userInfo {
    font-size: 11px;
    opacity: 0.8;
}

/* ===============================
   íƒ­
================================ */
.tab {
    display:flex;
    justify-content:center;
    gap:10px;
    margin-bottom:20px;
}
.tab button {
    background:#333;
    color:white;
    font-size:15px;
    padding:8px 12px;
}
.tab button.active {
    background:#FFD700;
    color:black;
}

.tabContent { display:none; }
.tabContent.active { display:block; }

/* ===============================
   3ëŒ€ ê¸°ë¡
================================ */
#total3 {
      text-align: center;        /* ê°€ìš´ë° */
    font-size: 28px;           /* í¼ì§ */
    font-weight: 800;          /* êµµê²Œ */
    letter-spacing: 0.5px;     /* ì‚´ì§ ê³ ê¸‰ */
    margin: 20px 0 16px;
    color: #FFD700;
}

.rmInput {
    height:40px;
    text-align:center;
    background:#222;
    color:white;
    border-radius:8px;
}

/* ===============================
   ê¸°ë¡ í´ë”
================================ */
.recordFolders {
    display:flex;
    gap:8px;
    margin-top:15px;
}
.folderBtn {
    flex:1;
    background:#333;
    color:white;
    padding:10px;
}
.folderBtn.active {
    background:#FFD700;
    color:black;
}

.folderContent {
    display:none;
    margin-top:10px;
    background:#444;
    border-radius:8px;
    padding:10px;
    height:150px;
    overflow:auto;
}
.folderContent.active { display:block; }

/* ===============================
   ê¸°ë¡ ì…ë ¥ í•œ ì¤„
================================ */
.recordFormRow {
    display:flex;
    gap:6px;
    align-items:center;
    margin-top:12px;
}


.recordFormRow input[type="number"] {
    height:40px;
    border-radius:8px;
    background:#222;
    color:white;
}

/* ===============================
   ë‹¬ë ¥
================================ */
.calendar .header {
    display: grid;
    grid-template-columns: 48px 1fr 40px;
    align-items: center;
    margin-bottom: 14px;
}
   .month-title {
    font-size: 16px;
    font-weight: 600;
    color: #eee;
    white-space: nowrap;   /* ğŸ”¥ ì¤„ë°”ê¿ˆ ë°©ì§€ */
    text-align: center;
}
 .month-btn {
    background: transparent;
    border: none;
    color: #8b0000; /* ì–´ë‘ìš´ ë¹¨ê°• */
    font-size: 18px;
    padding: 8px 10px;
    cursor: pointer;
    opacity: 0.7;
}

.month-btn:active {
    opacity: 1;
    transform: scale(0.95);
}  
/* ===== ìš”ì¼ ===== */
.weekdays {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    margin-bottom: 8px;
}

.weekdays div {
    text-align: center;
    font-size: 12px;
    color: #aaa;
    letter-spacing: 0.5px;
    padding-bottom: 6px;
}

/* ì¼ìš”ì¼ ë¹¨ê°„ í¬ì¸íŠ¸ */
.weekdays div:last-child {
    color: #8b0000;
}

   /* ===== ë‚ ì§œ ê·¸ë¦¬ë“œ ===== */
.days {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 10px;
}

/* ë‚ ì§œ ì…€ */
/* ë‚ ì§œ ì…€ */
.days div {
  aspect-ratio: 1 / 1;
  background: #1a1a1a;
  border-radius: 12px;

  display: flex;
  align-items: center;
  justify-content: center;

  font-size: 15px;
  font-weight: 500;
  color: #eee;

  cursor: pointer;
  transition: all 0.18s ease;
}

/* hover (PC) */
.days div:hover {
  background: #2a2a2a;
  transform: translateY(-1px);
}

/* ì˜¤ëŠ˜ ë‚ ì§œ */
.days div.today {
  border: 1px solid #FFD700;
  color: #FFD700;
}

/* ìš´ë™í•œ ë‚  */
.days div.done {
  background: linear-gradient(135deg, #8b0000, #400000);
  color: white;
  font-weight: 600;
}



/* ì›” ì‹œì‘ ì „ ì§„ì§œ ë¹ˆì¹¸ë§Œ */
.days div.empty {
  background: transparent;
  cursor: default;
}





/* ===============================
   íŒì—…
================================ */
.popup {
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.7);
    display:flex;
    justify-content:center;
    align-items:center;
    z-index:9999;
}
.popup.hidden { display:none; }
.popup-box {
    background:#111;
    padding:20px;
    border-radius:12px;
    width:80%;
}
.muscles {
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:10px;
    margin:15px 0;
}
.muscles button.active {
    background:#8b0000;
    color:white;
}
.dateDisplay {
    width: 80px;
    height: 40px;
    background: #222;
    border-radius: 8px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-size: 11px;
    line-height: 1.2;
    color: #FFD700;
}

.dateYear {
    font-size: 11px;
    opacity: 0.85;
}

.dateMD {
    font-size: 13px;
    font-weight: bold;
}
.tabContent {
  display: none;
}

.tabContent.active {
  display: block;
}
.loginBtn {
  background: #1c1c1c;
  color: #ddd;

  border: 1px solid #333;
  border-radius: 10px;

  padding: 6px 12px;
  font-size: 12px;
  font-weight: 500;

  cursor: pointer;
  transition: all 0.15s ease;
}

.loginBtn:hover {
  background: #222;
  border-color: #444;
}

.loginBtn:active {
  background: #111;
}
   .loginBtn.loggedIn {
  background: none;
  border: none;
  color: #aaa;
  padding: 0;
}
.days div.done:hover { background: linear-gradient(135deg, #8b0000, #400000) !important; transform: translateY(-1px); }

/* ğŸ”’ ëª¨ë°”ì¼ long press í…ìŠ¤íŠ¸ ì„ íƒ ë°©ì§€ */
.days div,
.popup,
.popup * {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;

  -webkit-touch-callout: none; /* iOS ë³µì‚¬ ë©”ë‰´ ì°¨ë‹¨ */
}

.part-btn {
  background: #000;
  color: #fff;
  border: 1px solid #fff;
  border-radius: 12px;
  padding: 14px;
  font-size: 16px;
  letter-spacing: 1px;
}
.exercise-search {
  width: 100%;
  height: 36px;          /* â† í•µì‹¬ (ë³´í†µ 52~56pxì—ì„œ ì¤„ì„) */
  background: #111;      /* ì™„ì „ ë¸”ë™ âŒ ì‚´ì§ ë°ì€ ë¸”ë™ */
  color: #fff;
  border: 1px solid #333;
  border-radius: 8px;
  padding: 0 12px;
  font-size: 14px;
}

.exercise-search::placeholder {
  color: #777;
}

.exercise-search:focus {
  outline: none;
  border-color: #fff;
}
.search-wrap {
  margin-bottom: 12px;
}

   .search-wrap {
  display: flex;
  gap: 8px;
  margin-bottom: 12px;
}

.exercise-search {
  flex: 1;
  height: 36px;
  background: #111;
  color: #fff;
  border: 1px solid #333;
  border-radius: 8px;
  padding: 0 12px;
  font-size: 14px;
}

.add-btn {
  width: 36px;
  height: 36px;
  background: #000;
  color: #fff;
  border: 1px solid #333;
  border-radius: 8px;
  font-size: 20px;
  cursor: pointer;

  /* ğŸ”¥ ì´ 3ì¤„ì´ í•µì‹¬ */
  display: flex;
  align-items: center;
  justify-content: center;

  line-height: 1; /* ê¸€ì í”ë“¤ë¦¼ ë°©ì§€ */
}
.add-btn:active {
  background: #222;
  transform: scale(0.96);
}
.exercise-card {
  background: #111;
  border: 1px solid #222;
  border-radius: 14px;
  padding: 14px 16px;
  margin-bottom: 10px;

  display: flex;
  flex-direction: column;
  gap: 6px;

  cursor: pointer;
  transition: all 0.15s ease;
}

.exercise-card:hover {
  background: #161616;
  border-color: #333;
}

.exercise-card:active {
  transform: scale(0.985);
}

.exercise-name {
  font-size: 16px;
  font-weight: 600;
  color: #fff;
  letter-spacing: 0.3px;
}

.exercise-sub {
  font-size: 13px;
  color: #777;
}

.calendar-toggle {
  margin-top: 12px;
  padding: 8px 14px;
  border-radius: 8px;
  background: #2a2a2a;
  color: #eee;
  font-size: 13px;
  border: none;
  cursor: pointer;
}

.calendar-toggle.active {
  background: #8b0000;
  color: #fff;
}
/* í† ê¸€ ê°ì‹¸ëŠ” ì˜ì—­ */
.calendar-toggle-wrap {
  margin-top: 10px;
  display: flex;
  justify-content: flex-start; /* ì™¼ìª½ ì •ë ¬ */
}

/* ì•Œì•½ ìŠ¤ìœ„ì¹˜ */
.toggle-switch {
  width: 48px;          /* â† ê±°ì˜ 1/7 ëŠë‚Œ */
  height: 26px;
  background: #3a3a3a;
  border-radius: 999px;
  position: relative;
  cursor: pointer;
  transition: background 0.25s ease;
}

/* ì•ˆì— êµ¬ìŠ¬ */
.toggle-switch::after {
  content: "";
  width: 20px;
  height: 20px;
  background: #ddd;
  border-radius: 50%;
  position: absolute;
  top: 3px;
  left: 3px;
  transition: transform 0.25s ease;
}

/* ON ìƒíƒœ */
.toggle-switch.active {
  background: linear-gradient(135deg, #8b0000, #400000);
}

.toggle-switch.active::after {
  transform: translateX(22px);
}

/* ì¢…ëª© ëª¨ë“œ ì „ìš© */
.calendar.muscle-mode .days div {
  font-weight: 400;        /* ì–‡ê²Œ */
  font-size: 14px;         /* ë‚ ì§œë³´ë‹¤ ì‚´ì§ ì‘ê²Œ */
  letter-spacing: 0.2px;
}

/* ìš´ë™í•œ ë‚  ë°°ê²½ì€ ìœ ì§€ */
.calendar.muscle-mode .days div.done {
  font-weight: 400;
}

/* ë‚ ì§œ ëª¨ë“œëŠ” ì ˆëŒ€ ì˜í–¥ ì•ˆ ë°›ìŒ */

   
   
/* .css ë¶™ì—¬ë„£ê¸° */
   


   
/* ğŸ”¥ number input +/- ë²„íŠ¼ ì œê±° */
input[type="number"]::-webkit-outer-spin-button,
input[type="number"]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

input[type="number"] {
    -moz-appearance: textfield; /* Firefox */
}
   /* ===============================
   1RM ì…ë ¥ í­ 2/3
================================ */
#tab1 #weight,
#tab1 #reps,
#tab1 #goBtn {
    width: 66%;          /* ê°€ë¡œ 2/3 */
    height: auto;        /* ë†’ì´ ìë™ */
    padding: 8px;        /* ì ë‹¹íˆ ì¤„ì„ */
    font-size: 16px;     /* ê¸€ì í¬ê¸° */
    margin: 10px auto;   /* ê°€ìš´ë° ì •ë ¬ */
    display: block;
    border-radius: 10px; /* ë‘¥ê¸€ê²Œ ìœ ì§€ */
}

#tableArea {
    margin-top: 30px;   /* ê¸°ì¡´ì— ì—†ìœ¼ë©´ ì¶”ê°€ */
    /* ë˜ëŠ” padding-top: 30px; */
}
/* ì¢…ëª© ëª¨ë“œ ê¸€ì”¨ì²´ */
.calendar.muscle-mode .days div {
  font-family:
    -apple-system,
    BlinkMacSystemFont,
    "SF Pro Text",
    "Apple SD Gothic Neo",
    "Noto Sans KR",
    "Segoe UI",
    sans-serif;
}
/* ===============================
   3ëŒ€ ì ‘ê¸° UI
================================ */
.three-header {
  position: relative;
  margin: 20px 0 10px;
  text-align: center;
}

/* 3ëŒ€ í…ìŠ¤íŠ¸ */
#total3 {
      text-align: center;        /* ê°€ìš´ë° */
    font-size: 28px;           /* í¼ì§ */
    font-weight: 800;          /* êµµê²Œ */
    letter-spacing: 0.5px;     /* ì‚´ì§ ê³ ê¸‰ */
    margin: 20px 0 16px;
    color: #FFD700;
}

/* ì˜¤ë¥¸ìª½ ë²„íŠ¼ */
.three-toggle {
  position: absolute;
  right: 0;
  top: 50%;
  transform: translateY(-50%);
}


.three-toggle {
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: #333;
  border: none;
  cursor: pointer;
}

.three-toggle::after {
  content: "";
  width: 6px;
  height: 6px;
  background: #FFD700;
  border-radius: 50%;
  display: block;
  margin: auto;
}

/* ì ‘íŒ ìƒíƒœ */
#threeDetail {
  display: none;
}



   

    /* ìŠ¤íƒ€ì¼ ë§¨ë°‘ */
</style>
</head>

<body>
<div class="app">
   
    <div class="topBar">
    <!-- ì™¼ìª½ ë¬¸êµ¬ -->
       <div class="topText">
         <div>ëŒ€ë¶€ë¶„ì˜ ë¬¸ì œëŠ” ëˆì´ ì—†ì–´ì„œ,</div>
         <div>ê·¸ ì™¸ì˜ ë¬¸ì œëŠ” ê·¼ìœ¡ì´ ì—†ì–´ì„œ ìƒê¸´ë‹¤</div>
       </div>
    <!-- ì˜¤ë¥¸ìª½ ë¡œê·¸ì¸ ì˜ì—­ -->
       <div id="loginArea">
             <button id="googleLoginBtn" class="loginBtn">Google ë¡œê·¸ì¸</button>
            <button id="logoutBtn" class="loginBtn" style="display:none;">ë¡œê·¸ì•„ì›ƒ</button>
       <div id="userInfo"></div>
    </div>
  </div>   


   
<div class="container">


<!-- íƒ­ -->
<div class="tab">
    <button class="tabBtn active" data-target="tab1">1RM</button>
    <button class="tabBtn" data-target="tab2">3ëŒ€</button>
    <button class="tabBtn" data-target="tab3">ë‹¬ë ¥</button>
  <button class="tabBtn" data-target="tab4">Tip</button>


</div>

<!-- 1RM -->
<div id="tab1" class="tabContent active">
  <input id="weight" type="number" placeholder="kg">
    <select id="reps"></select>
    <button id="goBtn">GO</button>
    <div id="result"></div>
    <div id="tableArea"></div>
</div>

<!-- 3ëŒ€ -->
<div id="tab2" class="tabContent">

   
     <!-- ğŸ”¥ í—¤ë” -->
  <div class="three-header">
    <div id="total3">3ëŒ€: 0 kg</div>
    <button id="threeToggleBtn" class="three-toggle"></button>
  </div>

  <!-- ğŸ”½ ì ‘íˆëŠ” ì˜ì—­ -->
  <div id="threeDetail">
    <table>
        <tr><th>ë²¤ì¹˜</th><th>ìŠ¤ì¿¼íŠ¸</th><th>ë°ë“œ</th></tr>
        <tr>
            <td><input id="benchRM" class="rmInput" type="number"></td>
            <td><input id="squatRM" class="rmInput" type="number"></td>
            <td><input id="deadRM" class="rmInput" type="number"></td>
        </tr>
    </table>

    <button id="save3Btn">3ëŒ€ ê¸°ë¡ ì €ì¥</button>
</div>
    <div class="recordFolders">
        <button class="folderBtn active" data-target="benchBox">ë²¤ì¹˜</button>
        <button class="folderBtn" data-target="squatBox">ìŠ¤ì¿¼íŠ¸</button>
        <button class="folderBtn" data-target="deadBox">ë°ë“œ</button>
    </div>

    <div id="benchBox" class="folderContent active"></div>
    <div id="squatBox" class="folderContent"></div>
    <div id="deadBox" class="folderContent"></div>

  <div class="recordFormRow">
    <input type="hidden" id="recordDate">

    <div class="dateDisplay">
        <div class="dateYear" id="displayYear">2026</div>
        <div class="dateMD" id="displayMD">01.09</div>
    </div>
<input id="recordWeight" type="number" placeholder="kg">
        <input id="recordReps" type="number" placeholder="íšŒ">
        <button id="recordAdd">ì €ì¥</button>
    </div>
    <!-- âœ… ì—¬ê¸° -->
    <div id="recordMessage"
         style="font-size:12px; color:#FFD700; margin-top:6px;">
    </div>


        
</div>
<div id="tab4" class="tabContent">

<div id="acc-part-screen">
  <button class="part-btn" data-part="chest">chest</button>
  <button class="part-btn" data-part="back">back</button>
  <button class="part-btn" data-part="shoulder">shoulder</button>
  <button class="part-btn" data-part="leg">leg</button>
  <button class="part-btn" data-part="arm">arm</button>
</div>

<div id="exercise-screen" style="display:none;">
  <div id="exercise-header" style="margin-bottom:10px; cursor:pointer;">
    â† <span id="current-part-name"></span>
  </div>

<div class="search-wrap">
  <input
    id="exercise-search"
    class="exercise-search"
    placeholder="ì¢…ëª© ê²€ìƒ‰"
  />
  <button id="add-exercise-btn" class="add-btn">+</button>
</div>


  <div id="exercise-list"></div>


</div>


</div>



   
<div id="save3Result"></div>
<!-- ë‹¬ë ¥ -->
<div id="tab3" class="tabContent">
    <div class="calendar">
        <div class="header">
    <button id="calPrev" class="month-btn">&lt;</button>
    <div id="calMonth" class="month-title"></div>
    <button id="calNext" class="month-btn">&gt;</button>
</div>
        <div class="weekdays">
           <div>ì¼</div>
           <div>ì›”</div>
           <div>í™”</div>
           <div>ìˆ˜</div>
           <div>ëª©</div>
           <div>ê¸ˆ</div>
           <div>í† </div>
        </div>
        <div id="calDays" class="days"></div>
    
      <div class="calendar-toggle-wrap">
  <div id="calendarToggle" class="toggle-switch"></div>
</div>


    </div>
</div>

</div>

<!-- íŒì—… -->
<div id="calPopup" class="popup hidden">
    <div class="popup-box">
        <h3 id="calPopupDate"></h3>
        <div class="muscles">
            <button data-muscle="ê°€ìŠ´">ê°€ìŠ´</button>
            <button data-muscle="ë“±">ë“±</button>
            <button data-muscle="íŒ”">íŒ”</button>
            <button data-muscle="í•˜ì²´">í•˜ì²´</button>
            <button data-muscle="ì–´ê¹¨">ì–´ê¹¨</button>
        </div>
    </div>
</div>

<!-- ë¡œê·¸ì¸ -->


<!-- ğŸ”¥ JSëŠ” ë„¤ ê¸°ì¡´ ê·¸ëŒ€ë¡œ ë¶™ì´ë©´ ì •ìƒ ì‘ë™ -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

<script>
/* Firebase ì„¤ì • (ê¸°ì¡´ ê°’ ìœ ì§€) */
const firebaseConfig = {
    apiKey: "AIzaSyCXn174XsW6ndqaeUpVK6XAAf4MR0-q7_k",
    authDomain: "rmpj-7ca13.firebaseapp.com",
    projectId: "rmpj-7ca13",
    storageBucket: "rmpj-7ca13.firebasestorage.app",
    messagingSenderId: "983484366324",
    appId: "1:983484366324:web:5fd58faba825ee39decda1"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

/* ìš”ì†Œ ì°¸ì¡° */
const tabBtns = document.querySelectorAll('.tabBtn');
const tabContents = document.querySelectorAll('.tabContent');

const weightSelect = document.getElementById('weight');
const repsSelect = document.getElementById('reps');
const goBtn = document.getElementById('goBtn');
const resultDiv = document.getElementById('result');
const tableArea = document.getElementById('tableArea');

const benchRM = document.getElementById('benchRM');
const squatRM = document.getElementById('squatRM');
const deadRM = document.getElementById('deadRM');
const total3 = document.getElementById('total3');

const save3Btn = document.getElementById('save3Btn');
const save3Result = document.getElementById('save3Result');

const folderBtns = document.querySelectorAll('.folderBtn');
const folderContents = document.querySelectorAll('.folderContent');

const benchBox = document.getElementById('benchBox');
const squatBox = document.getElementById('squatBox');
const deadBox = document.getElementById('deadBox');

const recordDate = document.getElementById('recordDate');
const recordWeight = document.getElementById('recordWeight');
const recordReps = document.getElementById('recordReps');
const recordAdd = document.getElementById('recordAdd');
const recordMessage = document.getElementById('recordMessage');

const googleLoginBtn = document.getElementById('googleLoginBtn');
const logoutBtn = document.getElementById('logoutBtn');
const userInfo = document.getElementById('userInfo');
   
// ğŸ”¥ 1RM íšŸìˆ˜ ì˜µì…˜ ì´ˆê¸°í™”
for (let i = 1; i <= 10; i++) {
  const opt = document.createElement("option");
  opt.value = i;
  opt.textContent = `${i}íšŒ`;
  repsSelect.appendChild(opt);
}

tabBtns.forEach(btn => {
  btn.addEventListener('click', ()=>{
    calPopup.classList.add("hidden");

    tabBtns.forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');

    const target = btn.dataset.target;
    tabContents.forEach(tc=>{
      if(tc.id === target){
        tc.classList.add('active');
        tc.style.display = 'block';
      } else {
        tc.classList.remove('active');
        tc.style.display = 'none';
      }
    });

    // ğŸ”¥ Tip íƒ­ ì´ˆê¸°í™”
    if(target === 'tab4'){
      partScreen.style.display = 'block';
      exerciseScreen.style.display = 'none';
    }
  });
});


goBtn.addEventListener('click', ()=> {
    const weight = parseFloat(weightSelect.value);
    const reps = parseInt(repsSelect.value);

    if(!weight || !reps){
        tableArea.innerHTML = `<div style="text-align:center;color:#ff5555;margin-top:10px;">
                                   ë¬´ê²Œì™€ ë°˜ë³µìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”
                               </div>`;
        return;
    }

    const oneRM = weight * (1 + reps * 0.0333);

    // RMë§ˆë‹¤ ì„¸ë¡œ ê°„ê²© ë„“ê²Œ
    let html = '';
    for (let r=1; r<=10; r++){
        let rmWeight = oneRM / (1 + (r-1)*0.0333);
        html += `<div style="
                        text-align:center;
                        color:white;
                        margin:12px 0;   /* ê¸°ì¡´ 6px â†’ 12pxë¡œ ê°„ê²© ëŠ˜ë¦¼ */
                        font-size:16px;
                        font-weight:600;
                   ">
                        ${r}RM&nbsp;&nbsp;&nbsp;${rmWeight.toFixed(1)}kg
                 </div>`;
    }

    tableArea.innerHTML = html;
});



/* í˜ì´ë“œ í…ìŠ¤íŠ¸ ìœ í‹¸ */
function fadeOutElem(el, timeout=1000, fadeDur=800){
    el.style.opacity = 1;
    setTimeout(()=>{
        el.style.transition = `opacity ${fadeDur}ms ease`;
        el.style.opacity = 0;
        setTimeout(()=>{ el.innerHTML=''; el.style.opacity=1; el.style.transition=''; }, fadeDur);
    }, timeout);
}
function fadeTempMsg(el, msg, timeout=1000, fadeDur=800){
    el.innerHTML = msg;
    el.style.opacity = 1; 
    setTimeout(()=>{
        el.style.transition = `opacity ${fadeDur}ms ease`;
        el.style.opacity = 0;
        setTimeout(()=>{ el.innerHTML=''; el.style.opacity=1; el.style.transition=''; }, fadeDur);
    }, timeout);
}

   /* ===============================
   ğŸ”¥ ë³´ì¡°ìš´ë™(4ë²ˆì§¸ íƒ­) ë¡œì§
================================ */
let currentExercises = [];
const exerciseListEl = document.getElementById('exercise-list');
const addExerciseBtn = document.getElementById('add-exercise-btn');
   
addExerciseBtn.addEventListener('click', addExercise);

function renderExercises(){
  if (!currentExercises.length) {
    exerciseListEl.innerHTML =
      `<div style="color:#777;font-size:13px;">ì•„ì§ ì¶”ê°€ëœ ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤</div>`;
    return;
  }

exerciseListEl.innerHTML = currentExercises.map(name => `
  <div class="exercise-card">
    <div class="exercise-name">${name}</div>
    <div class="exercise-sub">ê¸°ë¡ ì—†ìŒ</div>
  </div>
`).join('');

}

async function loadExercises(part){
  const user = auth.currentUser;
  if (!user) {
    currentExercises = [];
    renderExercises();
    return;
  }

  const ref = db
    .collection('users')
    .doc(user.uid)
    .collection('accessories')
    .doc(part);

  const snap = await ref.get();

  currentExercises = snap.exists ? snap.data().list || [] : [];
  renderExercises();
}

async function addExercise(){
  const name = prompt("ìš´ë™ ì¢…ëª©ì„ ì…ë ¥í•˜ì‹œì˜¤");
  if (!name) return;

  currentExercises.unshift(name);
  renderExercises();

  const user = auth.currentUser;
  if (!user) return;

  await db
    .collection('users')
    .doc(user.uid)
    .collection('accessories')
    .doc(currentPart)
    .set({ list: currentExercises });
}


/* 3ëŒ€ ì´í•© ì—…ë°ì´íŠ¸ */
function updateTotal3(){
    const b = parseInt(benchRM.value)||0;
    const s = parseInt(squatRM.value)||0;
    const d = parseInt(deadRM.value)||0;
    total3.textContent = `3ëŒ€: ${b+s+d} kg`;
}
[benchRM, squatRM, deadRM].forEach(el => el.addEventListener('input', updateTotal3));



/* save3Btn: ì „ì²´(3ëŒ€) ì €ì¥ â€” í•­ìƒ ë³´ì´ì§€ë§Œ FirestoreëŠ” ë¡œê·¸ì¸ ìˆì„ ë•Œë§Œ ì €ì¥ */
save3Btn.addEventListener('click', async ()=>{

    const user = auth.currentUser;

    if(!user){
        showSave3Message('ë¡œê·¸ì¸ í›„ ì €ì¥í•´ì£¼ì„¸ìš”');
        return;
    }

    const bench = parseInt(benchRM.value)||0;
    const squat = parseInt(squatRM.value)||0;
    const dead = parseInt(deadRM.value)||0;
    const total = bench + squat + dead;

    if(total === 0){
        showSave3Message('ê°’ì„ ì…ë ¥í•˜ì„¸ìš”');
        return;
    }

    try{
        await db
          .collection('users')
          .doc(user.uid)
          .collection('threeRM') // ğŸ”¥ ìˆ«ì ì œê±°
          .add({
              bench,
              squat,
              dead,
              total,
              createdAt: firebase.firestore.FieldValue.serverTimestamp()
          });

        showSave3Message('3ëŒ€ ê¸°ë¡ ì €ì¥ ì™„ë£Œ!');
    }catch(e){
        console.error('3ëŒ€ ì €ì¥ ì—ëŸ¬:', e);
        showSave3Message('ì €ì¥ ì‹¤íŒ¨ (ì½˜ì†” í™•ì¸)');
    }
});

/* í´ë” ë²„íŠ¼ ë™ì‘ (ê°€ë¡œ ë²„íŠ¼ â†’ í•˜ë‚˜ì˜ ë°•ìŠ¤ë§Œ active) */
folderBtns.forEach(btn=>{
    btn.addEventListener('click', ()=>{
        folderBtns.forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        const target = btn.dataset.target;
        folderContents.forEach(fc=>{
            if(fc.id === target) fc.classList.add('active');
            else fc.classList.remove('active');
        });
       renderActiveBox();
    });
});

/* ê¸°ë¡ ë°•ìŠ¤ ë°ì´í„° (ë¡œì»¬ mock) ë° ë Œë” í•¨ìˆ˜ */
const records = { bench: [], squat: [], dead: [] };

// í¬ë§· ë‚ ì§œ: '25.12.10'
function formatTodayYYMMDD(d = new Date()){
    const yy = String(d.getFullYear()).slice(2);
    const mm = String(d.getMonth()+1).padStart(2,'0');
    const dd = String(d.getDate()).padStart(2,'0');
    return `${yy}.${mm}.${dd}`;
}

// ì´ˆê¸° ë‚ ì§œ í‘œì‹œ
recordDate.value = formatTodayYYMMDD();

// ë Œë” í•¨ìˆ˜: í˜„ì¬ active folderì˜ ëª©ë¡ì„ ê·¸ë ¤ì¤Œ
function renderActiveBox(){
    const activeBtn = document.querySelector('.folderBtn.active');
    const target = activeBtn ? activeBtn.dataset.target : 'benchBox';
    let arr = [];
    if(target === 'benchBox') arr = records.bench;
    else if(target === 'squatBox') arr = records.squat;
    else if(target === 'deadBox') arr = records.dead;

    const boxEl = document.getElementById(target);
if(!arr || arr.length === 0){
    boxEl.innerHTML = `<div style="color:#777;font-size:13px;">ê¸°ë¡ì´ ì—¬ê¸°ì— ìŒ“ì…ë‹ˆë‹¤</div>`;
    return;
}

// ë‚ ì§œë³„ ê·¸ë£¹í™”
const grouped = {};
arr.forEach(it => {
  if (!grouped[it.date]) grouped[it.date] = [];
  grouped[it.date].push(it);
});

// ìµœì‹  ë‚ ì§œ ë¨¼ì €
const dates = Object.keys(grouped)
  .sort((a, b) => b.localeCompare(a)); // ğŸ”¥ ìµœì‹  ë‚ ì§œ ë¨¼ì €


boxEl.innerHTML = dates.map(date => {
 const records = grouped[date]
  .slice()
  .reverse(); // ğŸ”¥ ë°°ì—´ìˆœì„œ ì—­ìˆœ = ìµœì‹ ì´ ì•„ë˜



  return `
    <div style="margin-bottom:10px;">
      ${records.map((r, idx) => `
        <div style="display:flex; line-height:1.6;">
          <div style="width:90px;">
            ${idx === 0 ? date : ''}
          </div>
          <div
                 class="record-line"
                 
                 data-id="${r.firestoreId || r.localId}"
                 style="margin-left:auto; text-align:right; cursor:pointer;"
                  >
                 ${r.weight}kg Ã— ${r.reps}íšŒ
            </div>

        </div>
      `).join('')}
      <div style="border-bottom:1px solid rgba(255,255,255,0.25); margin-top:6px;"></div>
    </div>
  `;
}).join('');



}
renderActiveBox();

/* ê¸°ë¡ ì¶”ê°€ (ê°€ë¡œ í¼ì—ì„œ ì €ì¥) */
recordAdd.addEventListener('click', async ()=>{
    const weight = parseInt(recordWeight.value);
    const reps = parseInt(recordReps.value);

    if(!weight || !reps){
        fadeTempMsg(recordMessage, 'ë¬´ê²Œì™€ íšŸìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”', 900, 600);
        return;
    }

    const date = formatTodayYYMMDD();

    const activeBtn = document.querySelector('.folderBtn.active');
    const target = activeBtn ? activeBtn.dataset.target : 'benchBox';

    const lift =
      target === 'benchBox' ? 'bench' :
      target === 'squatBox' ? 'squat' :
      'dead';

    const item = {
        firestoreId: null,
       localId: Date.now() + Math.random(), // ğŸ”¥ ì¶”ê°€
        date,
        weight,
        reps
    };

if(lift === 'bench') records.bench.unshift(item);
if(lift === 'squat') records.squat.unshift(item);
if(lift === 'dead')  records.dead.unshift(item);

    recordWeight.value = '';
    recordReps.value = '';
    fadeTempMsg(recordMessage, 'ê¸°ë¡ ì¶”ê°€ ì™„ë£Œ', 700, 600);
    renderActiveBox();

    const user = auth.currentUser;
    if(user){
        try{
            const docRef = await db
              .collection('users')
              .doc(user.uid)
              .collection('records')
              .add({
                lift,
                date,
                weight,
                reps,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
              });

            item.firestoreId = docRef.id;
           
        }catch(e){
            console.error('Firestore add err', e);
        }
    }
});


/* ë¡œê·¸ì¸ (êµ¬ê¸€) */
googleLoginBtn.addEventListener('click', ()=>{
    const provider = new firebase.auth.GoogleAuthProvider();
    auth.signInWithPopup(provider).catch(e=>alert('ë¡œê·¸ì¸ ì‹¤íŒ¨: '+e.message));
});
logoutBtn.addEventListener('click', ()=> auth.signOut());

/* auth ìƒíƒœ ë³€í™” */
auth.onAuthStateChanged(async user=>{
    if(user){
        googleLoginBtn.style.display = 'none';
        logoutBtn.style.display = 'block';
        userInfo.textContent = user.displayName || user.email || '';

        /* ğŸ”¥ [ì¶”ê°€] 3ëŒ€ ê¸°ë¡ ìµœì‹ ê°’ ë¶ˆëŸ¬ì˜¤ê¸° */
        try{
            const threeSnap = await db
              .collection('users')
              .doc(user.uid)
              .collection('threeRM')
              .orderBy('createdAt', 'desc')
              .limit(1)
              .get();

            if(!threeSnap.empty){
                const data = threeSnap.docs[0].data();
                benchRM.value = data.bench || 0;
                squatRM.value = data.squat || 0;
                deadRM.value = data.dead || 0;
                updateTotal3(); // ì´í•© ê°±ì‹ 
            }
        }catch(e){
            console.error('load threeRM err', e);
        }

        /* ê¸°ì¡´ records ë¡œë“œ (ê·¸ëŒ€ë¡œ ìœ ì§€) */
        try{
            const snap = await db
              .collection('users')
              .doc(user.uid)
              .collection('records')
              .orderBy('createdAt','desc')
              .limit(200)
              .get();

            records.bench = [];
            records.squat = [];
            records.dead = [];

            snap.forEach(doc=>{
                const d = doc.data();
                if(!d || !d.lift) return;

               const item = {
               
  firestoreId: doc.id,
  date: d.date,
  weight: d.weight,
  reps: d.reps,
    createdAt: d.createdAt?.toMillis?.() || 0
};

                if(d.lift === 'bench') records.bench.push(item);
                if(d.lift === 'squat') records.squat.push(item);
                if(d.lift === 'dead') records.dead.push(item);
            });

            renderActiveBox();

        }catch(e){
            console.error('load records err', e);
        }

    } else {
        googleLoginBtn.style.display = 'block';
        logoutBtn.style.display = 'none';
        userInfo.textContent = '';
    }
/* ğŸ”¥ ë‹¬ë ¥ ë°ì´í„° ë¡œë“œ */
try {
  const snap = await db
    .collection("users")
    .doc(user.uid)
    .collection("calendar")
    .get();

  calData = {};

  snap.forEach(doc => {
    calData[doc.id] = doc.data();
  });

  calRender();
} catch (e) {
  console.error("calendar load error", e);
}

   
});



 

/* ë©”ì‹œì§€ í˜ì´ë“œì•„ì›ƒ */
function showSave3Message(msg) {
    save3Result.textContent = msg;
    save3Result.style.opacity = 1;

    setTimeout(() => {
        save3Result.style.transition = "opacity 0.8s";
        save3Result.style.opacity = 0;

        setTimeout(() => {
            save3Result.textContent = "";
            save3Result.style.transition = "";
            save3Result.style.opacity = 1;
        }, 800);
    }, 1000);
}
   
function setTodayDisplay() {
    const now = new Date();
    const year = now.getFullYear();
    const mm = String(now.getMonth() + 1).padStart(2, '0');
    const dd = String(now.getDate()).padStart(2, '0');

    document.getElementById("displayYear").textContent = `${year}`;
    document.getElementById("displayMD").textContent = `${mm}.${dd}`;
}

setTodayDisplay();

/******** ë‹¬ë ¥ + long press ì½”ë“œ ì—¬ê¸° ********/
/********************
 * ğŸ“… ë‹¬ë ¥ ë¡œì§ (tab3)
 ********************/

const calDaysEl = document.getElementById("calDays");
const calMonthEl = document.getElementById("calMonth");
const calendarToggleBtn = document.getElementById("calendarToggle");

const calendarToggle = document.getElementById("calendarToggle");

calendarToggle.addEventListener("click", () => {
  calendarMode = calendarMode === "date" ? "muscle" : "date";
  calendarToggle.classList.toggle("active");

  document.querySelector(".calendar")
    .classList.toggle("muscle-mode", calendarMode === "muscle");

  calRender();
});


   
const calPopup = document.getElementById("calPopup");
const calPopupDate = document.getElementById("calPopupDate");
const calMuscleBtns = calPopup.querySelectorAll(".muscles button");

let calCurrent = new Date();
   let calData = {}; // ğŸ”¥ Firestoreì—ì„œ ì±„ìš¸ ì˜ˆì •
let calendarMode = "date"; 
// "date" | "muscle"

let calSelectedDate = null;
let calSelectedMuscles = [];


function calRender() {
  calDaysEl.innerHTML = "";

  const y = calCurrent.getFullYear();
  const m = calCurrent.getMonth();
  calMonthEl.textContent = `${y}ë…„ ${m + 1}ì›”`;

  const first = new Date(y, m, 1);
  const start = first.getDay();
  const last = new Date(y, m + 1, 0).getDate();

  // ë¹ˆì¹¸
 for (let i = 0; i < start; i++) {
  const empty = document.createElement("div");
  empty.classList.add("empty");
  calDaysEl.appendChild(empty);
}

  const today = new Date();

  for (let d = 1; d <= last; d++) {
    const cell = document.createElement("div");
    const key = `${y}-${m + 1}-${d}`;

    // ì˜¤ëŠ˜ í‘œì‹œ
    if (
      d === today.getDate() &&
      m === today.getMonth() &&
      y === today.getFullYear()
    ) {
      cell.classList.add("today");
    }

    // ìš´ë™í•œ ë‚ 
    if (calData[key]?.muscles?.length) {
      cell.classList.add("done");
    }

    if (calendarMode === "date") {
      cell.textContent = d;
    } else {
      if (calData[key]?.muscles?.length) {
        cell.textContent = calData[key].muscles[0];
      } else {
        cell.textContent = "";
      }
    }

 // long press (ë‚ ì§œ ëª¨ë“œì—ì„œë§Œ)
let timer;



cell.addEventListener("mouseup", () => clearTimeout(timer));



cell.addEventListener("touchend", () => clearTimeout(timer));


    calDaysEl.appendChild(cell);
  }
}


   



let longPressTimer = null;
let calPopupOpen = false;  // íŒì—… ì—´ë ¸ëŠ”ì§€ ì²´í¬


// ë‚ ì§œ long press
document.addEventListener("mousedown", e => handleDatePressStart(e));
document.addEventListener("touchstart", e => handleDatePressStart(e));

function handleDatePressStart(e){
    // âŒ ì¢…ëª© ëª¨ë“œì—ì„œëŠ” long press ìì²´ ì°¨ë‹¨
    if (calendarMode === "muscle") return;

    const cell = e.target.closest(".days div");
    if(!cell || !cell.textContent) return;

    const key = `${calCurrent.getFullYear()}-${calCurrent.getMonth()+1}-${cell.textContent}`;

    longPressTimer = setTimeout(() => {
        calOpenPopup(key);
    }, 500);
}


document.addEventListener("mouseup", e => clearLongPress(e));
document.addEventListener("touchend", e => clearLongPress(e));
document.addEventListener("touchmove", e => clearLongPress(e));

function clearLongPress(e){
    if(calPopupOpen) {
        // íŒì—… ì—´ë ¤ìˆìœ¼ë©´ long press ë¬´ì‹œ
        longPressTimer && clearTimeout(longPressTimer);
        longPressTimer = null;
        return;
    }
    longPressTimer && clearTimeout(longPressTimer);
    longPressTimer = null;
}





calPopup.addEventListener("click", e => {
  // ë°°ê²½ë§Œ í´ë¦­í•˜ë©´ ë‹«ê¸°, ë‚´ë¶€ ë°•ìŠ¤ í´ë¦­ì€ ë¬´ì‹œ
  if (e.target === calPopup) calPopup.classList.add("hidden");
});

async function handleMuscleSelect(btn) {
  const user = auth.currentUser;
  if (!user) return;

  const m = btn.dataset.muscle;
  const alreadySelected = calSelectedMuscles.includes(m);

  calMuscleBtns.forEach(b => b.classList.remove("active"));

  if (alreadySelected) {
    delete calData[calSelectedDate];
    calSelectedMuscles = [];

    await db
      .collection("users")
      .doc(user.uid)
      .collection("calendar")
      .doc(calSelectedDate)
      .delete();
  } else {
    calSelectedMuscles = [m];
    btn.classList.add("active");

    calData[calSelectedDate] = { muscles: [m] };

    await db
      .collection("users")
      .doc(user.uid)
      .collection("calendar")
      .doc(calSelectedDate)
      .set({
        muscles: [m],
        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
      });
  }

  calRender();
  calPopup.classList.add("hidden");
  calPopupOpen = false;
}

   
calMuscleBtns.forEach(btn => {
  btn.addEventListener("pointerdown", () => {
    btn.classList.add("active"); // ëˆŒë¦¼ íš¨ê³¼
  });

  btn.addEventListener("pointerup", e => {
    e.preventDefault();
    handleMuscleSelect(btn); // ğŸ‘‰ í•œ ë²ˆì— ì„ íƒ + ì €ì¥ + ë‹«í˜
  });

  btn.addEventListener("pointerleave", () => {
    btn.classList.remove("active");
  });
});



function calOpenPopup(key) {
  calSelectedDate = key;
  calSelectedMuscles = calData[key]?.muscles || [];
  calPopupDate.textContent = key;

  calMuscleBtns.forEach(btn => {
    btn.classList.toggle("active", calSelectedMuscles.includes(btn.dataset.muscle));
  });

  calPopup.classList.remove("hidden");
  calPopupOpen = true;
}





   








document.getElementById("calPrev").onclick = () => {
  calCurrent.setMonth(calCurrent.getMonth() - 1);
  calRender();
};

document.getElementById("calNext").onclick = () => {
  calCurrent.setMonth(calCurrent.getMonth() + 1);
  calRender();
};

calRender();

   let recordPressTimer = null;

// PC
document.addEventListener("mousedown", e => {
  const line = e.target.closest(".record-line");
  if (!line) return;

  recordPressTimer = setTimeout(() => {
    if (confirm("ì´ ê¸°ë¡ì„ ì‚­ì œí• ê¹Œìš”?")) {
      deleteRecord(line.dataset.id);
    }
  }, 600);
});

document.addEventListener("mouseup", () => {
  clearTimeout(recordPressTimer);
});

// ëª¨ë°”ì¼
document.addEventListener("touchstart", e => {
  const line = e.target.closest(".record-line");
  if (!line) return;

  recordPressTimer = setTimeout(() => {
    if (confirm("ì´ ê¸°ë¡ì„ ì‚­ì œí• ê¹Œìš”?")) {
      deleteRecord(line.dataset.id);
    }
  }, 600);
});

document.addEventListener("touchend", () => {
  clearTimeout(recordPressTimer);
});

document.addEventListener("touchmove", () => {
  clearTimeout(recordPressTimer);
});

async function deleteRecord(id){
  if(!id) return;

  ["bench","squat","dead"].forEach(type=>{
    records[type] = records[type].filter(r =>
      r.firestoreId !== id && r.localId !== id
    );
  });

  renderActiveBox();

  const user = auth.currentUser;
  if(user && String(id).length > 10){ // firestoreIdì¼ ë•Œë§Œ


    await db
      .collection('users')
      .doc(user.uid)
      .collection('records')
      .doc(id)
      .delete();
  }
}



const partScreen = document.getElementById('acc-part-screen');
const exerciseScreen = document.getElementById('exercise-screen');
const partTitle = document.getElementById('current-part-name');
const partBtns = document.querySelectorAll('.part-btn');

let currentPart = null;

partBtns.forEach(btn => {
  btn.addEventListener('click', () => {
    currentPart = btn.dataset.part;

    partScreen.style.display = 'none';
    exerciseScreen.style.display = 'block';
    partTitle.textContent = currentPart;
  });
});

document.getElementById('exercise-header').addEventListener('click', () => {
  exerciseScreen.style.display = 'none';
  partScreen.style.display = 'block';
});
const threeToggleBtn = document.getElementById("threeToggleBtn");
const threeDetail = document.getElementById("threeDetail");

threeToggleBtn.addEventListener("click", () => {
  threeDetail.style.display =
    threeDetail.style.display === "none" || !threeDetail.style.display
      ? "block"
      : "none";
});



   


</script>
<!-- âš ï¸ ì—¬ê¸° ì•„ë˜ì— ë„¤ê°€ ì“°ë˜ JS ê·¸ëŒ€ë¡œ ìœ ì§€ -->
</body>
</html>
